pipeline {
    agent any
    environment {
       tgBot_id = credentials('tgBot_id')
       openai_api_key = credentials('openai_api_key')
       newsApi_key = credentials('newsApi_key')
       newsApi_url = credentials('newsApi_url')
    }

    stages {
       stage('get python and modules'){
            steps {
                sh 'sudo apt update'
                sh 'sudo apt install python3.10 -y'
                sh 'sudo apt install python3-pip -y'
                sh 'sudo pyvenv /var/lib/jenkins/workspace/newsBot/venv'
                sh 'sudo /var/lib/jenkins/workspace/newsBot/venv/python3 pip install -r /var/lib/jenkins/workspace/newsBot/requirements.txt'
                   }
        }
       stage('runBot'){
            steps {
                sh 'echo HELLO'
                sh 'echo ${tgBot_id}'
                sh 'python3 main.py'
                   }
        }
    }
    }